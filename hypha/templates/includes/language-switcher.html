{% load i18n heroicons %}
<!-- Language switcher -->
<div x-data="{ open: false }" x-on:keydown.escape="open = false"  class="inline-block relative" >
    <button
        x-on:click="open = ! open"
        aria-label="{% trans "Language switcher" %}"
        aria-controls="id-language-switcher"
        type="button"
        :class="open ? 'bg-gray-900 text-white' : 'hover:bg-slate-200'"
        :aria-expanded="open"
        title="{% trans "Language switcher" %}"
        class="flex p-2 text-gray-900 rounded-full transition-all group"
    >
        {% heroicon_outline "language" class="inline transition-transform group-hover:scale-110" aria_hidden="true" %}
    </button>

    <!-- panel -->
    <div
        x-cloak
        x-show="open"
        x-trap="open"
        x-transition
        x-transition.origin.top
        @click.outside="open = false"
        class="overflow-y-scroll fixed top-0 z-30 bg-white rounded border shadow-md md:absolute md:top-auto start-0 end-0 md:start-auto md:min-w-[400px] md:max-h-[500px]"
    >
        <header class="flex gap-2 justify-between items-center py-2 px-3 bg-gray-100 border-b subheading">
            <span class="font-medium SubMenuHeading text-inherit">
                {% trans "Language switcher" %}
            </span>
            <button type="button" @click='open = false' class="opacity-70 appearance-none hover:opacity-100">
                {% heroicon_solid "x-mark" aria_hidden="true" fill="currentColor" %}
            </button>
        </header>

        <div id="id-language-switcher" class="p-4">
            {% get_language_info_list for LANGUAGES as languages %}
            {% if languages|length > 1 %}
                <form action="" method="post" class="my-2">
                    {% csrf_token %}
                    <fieldset class="grid grid-cols-2 gap-x-4">
                        {% for language in languages %}
                            <div>
                                <input class="sr-only" name="language" id="{{ language.code }}" value="{{ language.code }}" type="radio" {% if language.code == LANGUAGE_CODE %}checked{% endif %} onchange="this.form.submit()">
                                <label class="font-semibold capitalize cursor-pointer hover:underline text-dark-blue" for="{{ language.code }}">{{ language.name_local }}</label>
                            </div>
                        {% endfor %}
                    </fieldset>
                </form>
            {% else %}
                <span class="text-red-500">{% trans "Can't switch language. Only one language is active." %}</span>
            {% endif %}
        </div>
    </div>
</div>

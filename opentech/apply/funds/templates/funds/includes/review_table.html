{% load review_tags %}
<ul class="reviews-sidebar js-reviews-sidebar">
    {% if reviews_exist %}
        <li class="reviews-sidebar__item reviews-sidebar__item--header">
            <div></div>
            <div>{{ recommendation|traffic_light }}</div>
            <div></div>
        </li>
    {% endif %}

    {% if not assigned_staff %}
        <li class="reviews-sidebar__no-reviews">No reviews yet</li>
    {% endif %}

    {% for review_data in reviews_block.role_reviewed %}
        {% include 'funds/includes/review_table_row.html' with review=review_data.review reviewer=review_data.reviewer role=review_data.role %}
    {% endfor %}

    {% for review_data in reviews_block.staff_reviewed %}
        {% include 'funds/includes/review_table_row.html' with review=review_data.review reviewer=review_data.reviewer %}
    {% endfor %}

    {% for review_data in reviews_block.role_not_reviewed %}
        {% include 'funds/includes/review_table_row.html' with reviewer=review_data.reviewer role=review_data.role missing=True %}
    {% endfor %}

    {% for review_data in reviews_block.staff_not_reviewed %}
        {% include 'funds/includes/review_table_row.html' with reviewer=review_data.reviewer missing=True %}
    {% endfor %}

    {% if object.stage.has_external_review %}
        <hr class="reviews-sidebar__split">
        {% if reviews_block.external_reviewed or reviews_block.external_not_reviewed %}

            {% for review_data in reviews_block.external_reviewed %}
                {% include 'funds/includes/review_table_row.html' with review=review_data.review reviewer=review_data.reviewer %}
            {% endfor %}

            {% for review_data in reviews_block.external_not_reviewed %}
                {% include 'funds/includes/review_table_row.html' with reviewer=review_data.reviewer missing=True class="is-hidden" %}
            {% endfor %}

            <li><a class="link link--bold link--underlined js-toggle-reviewers" href="#">All Assigned Advisors</a></li>
        {% endif %}
    {% endif %}
</ul>

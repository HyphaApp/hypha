<div id="payment-requests" class="payment-block">
    <div class="payment-block__header">
        <p class="payment-block__title">Reporting</p>
    </div>
    <div>
        <h6>Report frequency</h6>
        <p>
            {{ object.report_config.get_frequency_display }}
        </p>
        {% if request.user.is_apply_staff %}
        <p>
            <div class="modal" id="change-frequency">
                {{ object.report_config.last_report.serialize|json_script:"lastReportData" }}
                <h4 class="modal__header-bar">Change reporting frequency</h4>
                <p>Schedule reports every:</p>
                {% include 'funds/includes/delegated_form_base.html' with form=update_frequency_form value='Continue'%}
            </div>
            <a data-fancybox
               data-src="#change-frequency"
               href="#">
                Change
            </a>
        </p>
        {% endif %}
    </div>
    <div>
    {% for report in object.report_config.past_due_reports %}
        {% include "application_projects/includes/report_line.html" with report=report %}
    {% endfor %}
    {% with next_report=object.report_config.current_due_report %}
        {% include "application_projects/includes/report_line.html" with report=next_report current=True %}
    {% endwith %}

    </div>
    <table class="payment-block__table">
        <thead>
            <tr>
                <th class="payment-block__table-date">Period End</th>
                <th class="payment-block__table-date">Submitted</th>
                <th class="payment-block__table-date">Privacy</th>
                <th class="payment-block__table-update"></th>
            </tr>
        </thead>
        <tbody>
            {% for report in object.reports.done %}
            <tr>
                <td>
                    <span class="payment-block__mobile-label">Period End: </span>{{ report.end_date }}
                </td>
                <td>
                    <span class="payment-block__mobile-label">Submitted: </span>{{ report.submitted_date|default:"Skipped" }}
                </td>
                <td>
                    <span class="payment-block__mobile-label">Privacy: </span>{% if report.public %}Public{% else %}Private{% endif %}
                </td>
                <td>
                    {% if request.user.is_apply_staff %}
                        <a href="{% url "apply:projects:reports:edit" pk=report.pk %}">Edit</a>
                        {% if report.skipped %}
                            <form action="{% url "apply:projects:reports:skip" pk=report.pk %}" method="post">
                                {% csrf_token %}
                                <input type="submit" value="Unskip" class="btn"></input>
                            </form>
                        {% endif %}
                    {% endif %}
                    <a href="{% url "apply:projects:reports:detail" pk=report.pk %}">view</a>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="4">No reports submitted</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
